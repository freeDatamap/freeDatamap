/*-------------------------
http://www.freedatamap.com/
---------------------------

freeDatamap no-charge License

Copyright 2013-2016, freeDatamap / Patrick Duverger
All rights reserved.

--------------
PLAIN SUMMARY:
--------------

You may use freeDatamap at no charge in non-commercial apps, web sites, components, and other software as long as end users are not charged a fee of any kind to use your product or gain access to any part of it. If your client pays you for your site/product using the freeDatamap technology, you should have signed up for the freeDatamap commercial licence before. You can ask for the full commercial license here freedatamap@gmail.com.

Use at your own risk. No warranties are offered.

Respect the copyright.

Redistributions of source code in non-commercial usage must retain the above copyright notice, the plain summary and the following list of conditions.

Redistributions in binary form must reproduce the above copyright notice, the plain summary and the following list of conditions in the documentation and/or other materials provided with the distribution.

The name freeDatamap may not be used to endorse or promote products derived from this software without specific prior written permission. Ask freedatamap@gmail.com for details.

---------
LEGALESE:
---------

This is a legal agreement between you (either an individual or a single entity) and freeDatamap, for the proprietary freeDatamap code and all other files that are available for download at http://www.freedatamap.com (this code and documentation, as well as any updates which may at freeDatamap's sole discretion be provided to you from time to time, are referred to in this Agreement as "PROGRAM"). By downloading, copying, or otherwise using the PROGRAM, you agree to the terms and conditions of this Agreement.
If you do not agree to the terms and conditions of this Agreement, please do not download or use the PROGRAM.

I. LICENSE

A. Subject to the terms and conditions of this Agreement, freeDatamap hereby grants you a non-exclusive, worldwide, non-transferable right to use the PROGRAM in apps, web sites, games, components and other software applications ("Developed Works") for which the end user is NOT charged any fees.
If you would like to use the code in a commercially licensed Developed Work for which end users are charged a fee (either for usage or access), simply sign up for the appropriate commercial freeDatamap License by asking at freedatamap@gmail.com.

II. LIMITATION OF LICENSE AND RESTRICTIONS

A. You agree that you will not sell, rent, or license the PROGRAM's source code or any derivative works thereof to any third party without the prior written consent of freeDatamap. Distribution of the PROGRAM as part of your Developed Work is acceptable so long as it is used exclusively as a part of your Developed Work without any charge for the end user. You agree not to modify or delete freeDatamap's existing copyright notices located in the source code.

B. You may use, duplicate, and distribute the compiled object code as embedded in Developed Works created by you, either for your own use or for distribution to a third party so long as end users of the Developed Work are not charged a fee for usage of or access to any portion of the Developed Work.

C. You may make modifications to the source code exclusively for your own use in order to perform bug fixes or other minor edits required to operate the PROGRAM as originally intended.

III. CONSIDERATION

A. The license rights granted to you under this Agreement are at no charge, but only in the following circumstances: If on your own behalf or on behalf of a third party you incorporate the PROGRAM into a web site, app, game, program or any component thereof (collectively, "Developed Work"), which in the case of a web site, must be accessible to internet users without payment of a fee of any kind, and in the case of a software application, game, program or component, neither you nor anyone to whom you distribute the Developed Work charges a user a fee of any kind to use such Developed Work or application, game, program or component into which such Developed Work is embedded. The foregoing shall apply regardless of whether you are paid to create such Developed Work.

B. In the event your intended use of the PROGRAM does not meet the criteria for the "no charge" license rights set forth in the immediately preceding paragraph, then you are not licensed to use the PROGRAM under this Agreement and must license the PROGRAM under freeDatamap's commercial license and ask freeDatamap for that at freedatamap@gmail.com.

C. You may make modifications to the source code exclusively for your own use in order to perform bug fixes or other minor edits required to operate the PROGRAM as originally intended.

IV. TITLE AND OWNERSHIP

In the scope of this present non-commercial license, the PROGRAM is licensed, not sold, and is protected by copyright laws and international treaty provisions. You acknowledge that no title to the intellectual property in the PROGRAM is transferred to you. You further acknowledge that title and full ownership rights to the PROGRAM, including all intellectual property rights therein, will remain the exclusive property of freeDatamap and you will not acquire any rights to the PROGRAM except as expressly set forth in this Agreement. You agree that any copies of the PROGRAM you make will contain the same proprietary notices which appear on and in the PROGRAM. You agree that freeDatamap may identify you as a licensee unless you make a written request otherwise. freeDatamap hereby grants to you the right to disclose that your product, game, software application, component, or other Developed Work makes use of freeDatamap code (for example, "Powered by freeDatamap").

V. DISCLAIMER OF WARRANTY AND LIMITATION OF LIABILITY

A. THE PROGRAM IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. freeDatamap DOES NOT WARRANT THAT THE FUNCTIONS CONTAINED IN THE PROGRAM WILL MEET YOUR REQUIREMENTS OR THAT OPERATION WILL BE UNINTERRUPTED OR ERROR FREE.
IN NO EVENT SHALL FREEDATAMAP BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

B. freeDatamap may, at its sole discretion, provide support services, but has no obligation to do so.

VI. TERMINATION

If you at any time fail to abide by the terms of this Agreement, freeDatamap shall have the right to immediately terminate the license granted herein and pursue any other legal or equitable remedies available.

VII. MISCELLANEOUS

A. This agreement represents the complete and exclusive statement of the agreement between freeDatamap and you and supersedes all prior agreements, proposals, representations and other communications, verbal or written, between them with respect to use of the program. This agreement may be modified only with the mutual written approval of authorized representatives of the parties.

B. The terms and conditions of this Agreement shall prevail notwithstanding any different, conflicting, or additional terms or conditions which may appear in any purchase order or other document submitted by you. You agree that such additional or inconsistent terms are deemed rejected by freeDatamap.

C. freeDatamap and you agree that any xerographically or electronically reproduced copy of this Agreement shall have the same legal force and effect as any copy bearing original signatures of the parties.*/


function dm_ServerTools(){}function dm_BeforeAll(){}dm_ServerTools.ARRAY_PROPS={length:"number",sort:"function",slice:"function",splice:"function"},dm_ServerTools.isArray=function(a){if(!a||"number"==typeof a||"string"==typeof a||"boolean"==typeof a)return!1;if(a instanceof Array)return!0;for(var b in dm_ServerTools.ARRAY_PROPS)if(!(b in a&&typeof a[b]==dm_ServerTools.ARRAY_PROPS[b]))return!1;return!0},dm_ServerTools.parseAtomic=function(a){var b=a;if("true"==b)b=!0;else if("false"==b)b=!1;else if(b&&!isNaN(b))try{var c=parseFloat(b);isNaN(c)||(b=c)}catch(d){}return b},dm_ServerTools.getUrlFirstArg=function(a){var b={},c=a.lastIndexOf("?");0>c&&(c=0),a=a.substring(c+1);var d=a.indexOf("&");d>0&&(a=a.substring(0,d));var e=a.indexOf("=");return e>0?(b.command=a.substring(0,e),b.value=a.substring(e+1)):b.command=a,b},dm_ServerTools.replaceAll=function(a,b,c){return a.split(b).join(c)},dm_ServerTools.getUrlParams=function(a){var b,c=a.lastIndexOf("?");0>c&&(c=0),a=a.substring(c+1);for(var d=function(a){for(var b,c=0;2>c;c++)0==c&&(b||(b={}),b.name=a[c]),1==c&&(b.value=a[c]);return b},e=a.split("&"),f=0;f<e.length;f++){var g=e[f].split("=");b?dm_ServerTools.isArray(b)?b.push(d(g)):b=[b,d(g)]:b=d(g)}return b},dm_ServerTools.getUrlParam=function(a,b){var c,d=dm_ServerTools.getUrlParams(a);if(dm_ServerTools.isArray(d))for(var e,f=0;!c&&f<d.length;f++)e=d[f],e.name==b&&(c=e.value);else b==d.name&&(c=d.value);return c=dm_ServerTools.parseAtomic(c)},dm_ServerTools.defaultDiacriticsRemovalap=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],dm_ServerTools.diacriticsMap={},dm_ServerTools.createDiacriticsMap=function(){for(var a=0;a<dm_ServerTools.defaultDiacriticsRemovalap.length;a++)for(var b=dm_ServerTools.defaultDiacriticsRemovalap[a].letters.split(""),c=0;c<b.length;c++)dm_ServerTools.diacriticsMap[b[c]]=dm_ServerTools.defaultDiacriticsRemovalap[a].base},dm_ServerTools.createDiacriticsMap(),dm_ServerTools.removeDiacritics=function(a){function b(a){return dm_ServerTools.diacriticsMap[a]||a}if(a)return(""+a).replace(/[^\u0000-\u007E]/g,b)},dm_ServerTools.removeSpecialChars=function(a,b){return a=b?a.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi,"_"):a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"_")},dm_ServerTools.formatJSVarName=function(a,b){if(!a)return void console.log("Warning : giving null to dm_ServerTools.formatJSVarName");var a=dm_ServerTools.removeDiacritics(a);return a=dm_ServerTools.removeSpecialChars(a,b),a=a.replace(/\ /g,"_")},dm_ServerTools.equalsOrRexgexpMatch=function(a,b,c){var d=a==b;if(!d&&c)try{var e=new RegExp(a);d=e.test(b),d&&a.length!=b.length&&(a.indexOf(b)>=0||b.indexOf(a)>=0)&&(d=!1)}catch(f){}return d},dm_ServerTools.getChildIndexAndObj=function(a,b){var c;if(a){var d,e;if(a.children)for(d=0;!c&&d<a.children.length;d++)e=a.children[d],e&&dm_ServerTools.equalsOrRexgexpMatch(b,e.name)&&(c={index:d,obj:e})}return c},dm_ServerTools.getChild=function(a,b,c){var d=dm_ServerTools.getChildIndexAndObj(a,b,c);return d&&(d=d.obj),d},dm_ServerTools.encode_utf8=function(a){return encode_latin1(unescape(encodeURIComponent(a)))},dm_ServerTools.encode_latin1=function(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a.charCodeAt(c);if((255&d)!==d)throw{message:"Cannot encode string in Latin1",str:a};b[c]=255&d}return b},dm_ServerTools.decode_utf8=function(a){return decodeURIComponent(escape(decode_latin1(a)))},dm_ServerTools.decode_latin1=function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")},dm_ServerTools.to_hex=function(a){for(var b=[],c=0;c<a.length;c++)b.push("0123456789abcdef"[a[c]>>4&15]),b.push("0123456789abcdef"[15&a[c]]);return b.join("")},dm_ServerTools.from_hex=function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length/2;c++)b[c]=parseInt(a.substr(2*c,2),16);return b},dm_ServerTools.hexEncode=function(a){var b,c,d="";for(c=0;c<a.length;c++)b=a.charCodeAt(c).toString(16),1==b.length&&(b="0"+b),0==b.length&&(b="00"),d+=b;return d},dm_ServerTools.hexDecode=function(a){var b,c=a.match(/.{1,2}/g)||[],d="";for(b=0;b<c.length;b++)d+=String.fromCharCode(parseInt(c[b],16));return d},dm_ServerTools.formatStr2fileName=function(a){return a=a.replace(/@/g,"_at_"),a=a.replace(/\./g,"_dot_")},dm_ServerTools.zip=function(a,b){var c,b=b||"data";try{c=new nodeZip}catch(d){c=new JSZip}c.file(b,a);var e=c.generate({base64:!1,compression:"DEFLATE"});return e},dm_ServerTools.unzip=function(a,b){var c,d,b=b||"data";try{c=new nodeZip(a,{base64:!1,checkCRC32:!0}),d=c.files[b]._data}catch(e){c=new JSZip,c.load(a,{base64:!1}),d=c.file(b).asText()}return d},dm_BeforeAll.getWidthSaveAsSlider=function(){var a=$("#saveAs-modal").attr("borderMarginPercent");a||(a=10);var b=window.innerWidth*(1-a/100);return.6*b/2},dm_BeforeAll.updateSaveAsEntitiesValues=function(a){var a=a||jQuery.data($("#saveAsLevelSliderDivContainer")[0],"data").currentValue;dm_Tools.getConfig(dm_Datamap.currentDatamap.graph.center).maxDepthForExport=a,d3.selectAll("#saveAsFinalMaxDepthDivContainer").html("<h"+dm_UI_getFontSize()+">Chosen depth : "+a+"</h"+dm_UI_getFontSize()+">");var b=0==a?1:dm_Tools.countNodes(dm_Datamap.currentDatamap.graph.center,a,dm_Tools.getConfig(dm_Datamap.currentDatamap.graph.center).noLeafInReport);d3.selectAll("#saveAsFinalNbEntitiesDivContainer").html("<h"+dm_UI_getFontSize()+">Number of entities : "+b+"</h"+dm_UI_getFontSize()+">")},dm_BeforeAll.dm_AggregationWorker,dm_BeforeAll.dm_AggregationWorker_imports=[],dm_BeforeAll.postWholePageInit,dm_BeforeAll.displayAttrPanel=null!=dm_ServerTools.getUrlParam(document.URL,"displayAttrPanel")?dm_ServerTools.getUrlParam(document.URL,"displayAttrPanel"):window.innerWidth>dm_UI_minimumWidthToDisplayAttrPanel,dm_BeforeAll.readOnlyConfig=!1,dm_BeforeAll.displayAttributePanelButtons=!1,dm_BeforeAll.onlyGraph=dm_ServerTools.getUrlParam(document.URL,"onlyGraph"),dm_BeforeAll.recordStopAfterInactivity=parseInt(dm_ServerTools.getUrlParam(document.URL,"record"))||0,dm_BeforeAll.noBckgrnd=dm_ServerTools.getUrlParam(document.URL,"noBckgrnd"),dm_BeforeAll.noNodeText=dm_ServerTools.getUrlParam(document.URL,"noNodeText"),dm_BeforeAll.noaggreg=dm_ServerTools.getUrlParam(document.URL,"noAggreg"),dm_BeforeAll.noRotatingTarget=dm_ServerTools.getUrlParam(document.URL,"noRotatingTarget"),dm_BeforeAll.onNodeSelect,dm_BeforeAll.init=function(){dm_BeforeAll.readOnlyConfig&&(dm_BeforeAll.displayAttributePanelButtons=!1),dm_BeforeAll.onlyGraph&&(dm_BeforeAll.displayAttrPanel=!1)},dm_BeforeAll.getStyleSheetRule=function(a,b){var c;if("string"==typeof a){for(var d,e,f=!1,g=0;!f&&g<document.styleSheets.length;g++)e=document.styleSheets[g],d=e.href,c=e.rules||e.cssRules,d&&d.indexOf(a)>=0&&c&&c.length>0&&(f=!0);if(!f)return}for(var g=0;g<c.length;g++)if(c[g].selectorText==b)return c[g].style},dm_BeforeAll.getStyleSheetProp=function(a,b,c){var d=dm_BeforeAll.getStyleSheetRule(a,b),e=d[c],f=e.indexOf("px");if(f>0){e=e.substr(0,f);try{e=parseInt(e)}catch(g){}}return e},dm_BeforeAll.init();